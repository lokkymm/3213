import wmi
import hashlib

class FauwareAuthenticationSystem:
    def __init__(self):
        self.users = {'admin': {'password': 'password123', 'hwid': None},
                      'user1': {'password': 'securepass', 'hwid': None},
                      'user2': {'password': 'letmein', 'hwid': None}}
    
    def get_hwid(self):
        w = wmi.WMI()
        hwid = ""
        for disk in w.Win32_DiskDrive():
            hwid += disk.SerialNumber.strip()
        for processor in w.Win32_Processor():
            hwid += processor.ProcessorId.strip()
        for baseboard in w.Win32_BaseBoard():
            hwid += baseboard.SerialNumber.strip()
        return hashlib.md5(hwid.encode()).hexdigest()

    def login(self, username, password):
        if username in self.users and self.users[username]['password'] == password:
            if self.users[username]['hwid'] is None:
                self.users[username]['hwid'] = self.get_hwid()
                print("HWID locked for user", username)
            else:
                current_hwid = self.get_hwid()
                if self.users[username]['hwid'] == current_hwid:
                    return True
                else:
                    print("Unauthorized access. HWID mismatch detected.")
                    return False
        return False

# Example usage
fauware_auth = FauwareAuthenticationSystem()
username = input("Enter username: ")
password = input("Enter password: ")

if fauware_auth.login(username, password):
    print("Login successful. Welcome, " + username + "!")
else:
    print("Invalid username or password. Access denied.")
